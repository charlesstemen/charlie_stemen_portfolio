var app=angular.module("portfolio",["ngRoute","ui.bootstrap","app.controllers","app.services","app.directives"]),controllers=angular.module("app.controllers",[]),services=angular.module("app.services",[]),directives=angular.module("app.directives",[]);app.run(["$rootScope","$route",function(a,b){a.pageTitle="Home | Charles Stemen",a.mobileMenuCollapsed=!0,a.$on("$routeChangeSuccess",function(){a.mobileMenuCollapsed=!0,a.pageTitle=b.current.pageTitle+" | Charles Stemen"}),a.$on("$viewContentLoaded",function(){setTimeout(function(){$(".slide").fitVids(),$(".affix-container").css({width:function(){return $(this).parent().width()+"px"}}),$(window).on("resize",function(){$(".affix-container").css({width:function(){return $(this).parent().width()+"px"}})})},200)})}]),app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"partials/layout/home.html",controller:"HomeCtrl",pageTitle:"Home"}).when("/show/:category",{templateUrl:"partials/layout/home.html",controller:"HomeCtrl",pageTitle:":category"}).when("/project/:projectId",{templateUrl:"partials/layout/detail.html",controller:"DetailCtrl",pageTitle:":projectId",resolve:{theProject:["$route","$q","ProjectService",function(a,b,c){var d=b.defer();if(c.isInit()){var e=c.getProjectById(a.current.params.projectId);null!=e?d.resolve(e):d.reject(null)}else c.initData().then(function(){var b=c.getProjectById(a.current.params.projectId);null!=b?d.resolve(b):d.reject(null)},function(){d.reject(null)});return d.promise}]}}).when("/contact",{templateUrl:"partials/layout/contact.html",controller:"ErrorCtrl",pageTitle:"Contact"}).when("/error",{templateUrl:"partials/layout/error.html",controller:"ErrorCtrl",pageTitle:"Oh No!"}).otherwise({redirectTo:"/error"})}]),controllers.controller("MainCtrl",["$scope","$location","$modal",function(a,b,c){a.launchVideo=function(){c.open({templateUrl:"partials/modals/aboutMeModal.html",controller:"AboutMeModalCtrl"})},a.toggleCollapse=function(){a.$root.mobileMenuCollapsed=!a.$root.mobileMenuCollapsed},a.closeMenu=function(){a.$root.mobileMenuCollapsed=!0},a.clearFilters=function(){b.path("/"),a.$root.$broadcast("ROUTE_CHANGE_X_MENU")}}]),app.filter("offset",function(){return function(a,b){return b=parseInt(b,10),a.slice(b)}}),controllers.controller("DetailCtrl",["$scope","$sce","theProject",function(a,b,c){a.project=c,a.makeHTMLSafe=function(a){return""!=a?b.trustAsHtml(a):null}}]),controllers.controller("ErrorCtrl",["$scope",function(){}]),controllers.controller("HomeCtrl",["$scope","$routeParams","$location","ProjectService",function(a,b,c,d){a.filterApplied=b.category,a.filterApplied&&a.$root.$broadcast("FILTER_APPLIED",b.category),a.categoryFilter=function(c){if(a.filterApplied){var d=!1;return $.each(c.categories,function(a,c){c.slug==b.category&&(d=!0)}),d}return!0},a.clearFilters=function(){c.path("/"),a.$root.$broadcast("ROUTE_CHANGE_X_MENU")},d.isInit()?a.projects=d.getAllProjects():d.initData().then(function(b){a.projects=b})}]),controllers.controller("AboutMeModalCtrl",["$scope","$modalInstance",function(a,b){a.closeModal=function(){b.close()}}]),directives.directive("imageSlider",function(){return{restrict:"A",replace:!0,scope:{images:"=",projectPath:"="},templateUrl:"partials/includes/image-slider.html",link:function(a){a.currentIndex=1,a.next=function(){a.currentIndex<a.images.length?a.currentIndex++:a.currentIndex=1},a.prev=function(){a.currentIndex>1?a.currentIndex--:a.currentIndex=a.images.length},a.images.length&&(a.imageProxy=[],a.images.forEach(function(){var b={visible:!1};a.imageProxy.push(b)}),a.$watch("currentIndex",function(){a.imageProxy.forEach(function(a){a.visible=!1}),a.imageProxy[a.currentIndex-1].visible=!0}))}}}),directives.directive("activeStatus",[function(){return{link:function(a,b,c){a.$on("$routeChangeStart",function(){b.removeClass("active")}),a.$on("FILTER_APPLIED",function(a,d){d==c.category&&b.addClass("active")})}}}]),directives.directive("projectDescription",["$window",function(a){return{link:function(b,c){function d(){console.log("running"),b.$apply(function(){b.offset={width:$(c).parent().width()+"px"},b.affixed=265<=angular.element(a).scrollTop(),console.log(angular.element(a).scrollTop())})}b.affixed=!1,b.offset=0,angular.element(a).on("scroll",d),angular.element(a).on("resize",function(){b.$apply(function(){b.affixed=!1}),d()})}}}]),directives.directive("videoSlider",["$sce",function(a){return{restrict:"A",replace:!0,scope:{videos:"="},templateUrl:"partials/includes/video-slider.html",link:function(b,c){angular.element(c).find(".slide").bind(function(){console.log(this),this.fitVids()}),b.currentIndex=1,b.next=function(){b.currentIndex<b.videos.length?b.currentIndex++:b.currentIndex=1},b.prev=function(){b.currentIndex>1?b.currentIndex--:b.currentIndex=b.videos.length},b.makeHTMLSafe=function(b){return""!=b?a.trustAsHtml(b):null},"undefined"!=typeof b.videos&&(b.videoProxy=[],b.videos.forEach(function(c){var d={embed:a.trustAsHtml(c),visible:!1};b.videoProxy.push(d)}),b.$watch("currentIndex",function(){b.videoProxy.forEach(function(a){a.visible=!1}),b.videoProxy[b.currentIndex-1].visible=!0}))}}}]),services.factory("ProjectService",["$http","$q",function(a,b){var c=null,d=function(){return null!=c?!0:!1},e=function(){var d=b.defer();return a({method:"GET",url:"projects.json"}).then(function(a){c=a.data,d.resolve(a.data)},function(a){console.log(a),d.reject(a)}),d.promise},f=function(){return c},g=function(a){var b=null;return $.each(c,function(c,d){d.id==a&&(b=d)}),b};return{isInit:d,initData:e,getAllProjects:f,getProjectById:g}}]);